<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Adabiyotlar</title>
    <link rel="stylesheet" href="/static/blog/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #f8f9fa; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .adabiyotlar-container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); padding: 40px; }
        h1 { color: #764ba2; text-align: center; margin-bottom: 32px; }
        .adabiyot-list { list-style: none; padding: 0; }
        .adabiyot-item { display: flex; align-items: center; gap: 18px; padding: 18px 0; border-bottom: 1px solid #eee; }
        .adabiyot-item:last-child { border-bottom: none; }
        .adabiyot-icon { font-size: 2rem; color: #667eea; }
        .adabiyot-title { font-size: 1.1rem; font-weight: 500; color: #333; }
        .adabiyot-link { margin-left: auto; color: #10a37f; text-decoration: none; font-size: 0.95rem; padding: 8px 16px; background: #e6f9f0; border-radius: 6px; }
        .adabiyot-link:hover { background: #10a37f; color: #fff; }
        .back-btn { display: inline-block; margin-bottom: 20px; color: #667eea; text-decoration: none; font-size: 1rem; }
        .back-btn:hover { text-decoration: underline; }
        .empty-message { text-align: center; color: #888; padding: 40px; }
        .author-years { font-size: 0.85rem; color: #888; margin-left: 8px; }
    </style>
</head>
<body>
    <div class="adabiyotlar-container">
        <a href="{% url 'boshlash' %}" class="back-btn"><i class="fas fa-arrow-left"></i> Orqaga</a>
        <h1>Adiblar</h1>
        <input type="text" id="searchInput" placeholder="Adib nomini qidiring..." style="width:100%;padding:12px 16px;margin-bottom:24px;border-radius:8px;border:1px solid #eee;font-size:1rem;">
        <ul class="adabiyot-list" id="adabiyotList">
            {% for author in authors %}
            <li class="adabiyot-item">
                <span class="adabiyot-icon"><i class="fas fa-user-edit"></i></span>
                <span class="adabiyot-title">
                    {{ author.name }}
                    {% if author.birth_year or author.death_year %}
                    <span class="author-years">({{ author.birth_year|default:"?" }} - {{ author.death_year|default:"?" }})</span>
                    {% endif %}
                </span>
                <a class="adabiyot-link" href="{% url 'book_list' author.id %}"><i class="fas fa-book-open"></i> Kirish</a>
            </li>
            {% empty %}
            <li class="empty-message">
                <i class="fas fa-info-circle"></i> Hozircha adiblar qo'shilmagan. Admin paneldan qo'shing.
            </li>
            {% endfor %}
        </ul>
        <script>
        // Lotin-Krill konvertatsiya funksiyalari
        const latinToCyrillic = {
            'yo': 'ё', 'yu': 'ю', 'ya': 'я', 'ye': 'е', 'sh': 'ш', 'ch': 'ч', 'ng': 'нг',
            "o'": 'ў', "g'": 'ғ', "O'": 'Ў', "G'": 'Ғ',
            'Yo': 'Ё', 'Yu': 'Ю', 'Ya': 'Я', 'Ye': 'Е', 'Sh': 'Ш', 'Ch': 'Ч', 'Ng': 'Нг',
            'YO': 'Ё', 'YU': 'Ю', 'YA': 'Я', 'YE': 'Е', 'SH': 'Ш', 'CH': 'Ч', 'NG': 'НГ',
            'a': 'а', 'b': 'б', 'd': 'д', 'e': 'е', 'f': 'ф', 'g': 'г', 'h': 'ҳ',
            'i': 'и', 'j': 'ж', 'k': 'к', 'l': 'л', 'm': 'м', 'n': 'н', 'o': 'о',
            'p': 'п', 'q': 'қ', 'r': 'р', 's': 'с', 't': 'т', 'u': 'у', 'v': 'в',
            'x': 'х', 'y': 'й', 'z': 'з',
            'A': 'А', 'B': 'Б', 'D': 'Д', 'E': 'Е', 'F': 'Ф', 'G': 'Г', 'H': 'Ҳ',
            'I': 'И', 'J': 'Ж', 'K': 'К', 'L': 'Л', 'M': 'М', 'N': 'Н', 'O': 'О',
            'P': 'П', 'Q': 'Қ', 'R': 'Р', 'S': 'С', 'T': 'Т', 'U': 'У', 'V': 'В',
            'X': 'Х', 'Y': 'Й', 'Z': 'З'
        };
        
        const cyrillicToLatin = {
            'ё': 'yo', 'ю': 'yu', 'я': 'ya', 'ш': 'sh', 'ч': 'ch', 'ў': "o'", 'ғ': "g'",
            'Ё': 'Yo', 'Ю': 'Yu', 'Я': 'Ya', 'Ш': 'Sh', 'Ч': 'Ch', 'Ў': "O'", 'Ғ': "G'",
            'а': 'a', 'б': 'b', 'д': 'd', 'е': 'e', 'ф': 'f', 'г': 'g', 'ҳ': 'h',
            'и': 'i', 'ж': 'j', 'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n', 'о': 'o',
            'п': 'p', 'қ': 'q', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u', 'в': 'v',
            'х': 'x', 'й': 'y', 'з': 'z', 'э': 'e', 'ъ': "'", 'ь': '',
            'А': 'A', 'Б': 'B', 'Д': 'D', 'Е': 'E', 'Ф': 'F', 'Г': 'G', 'Ҳ': 'H',
            'И': 'I', 'Ж': 'J', 'К': 'K', 'Л': 'L', 'М': 'M', 'Н': 'N', 'О': 'O',
            'П': 'P', 'Қ': 'Q', 'Р': 'R', 'С': 'S', 'Т': 'T', 'У': 'U', 'В': 'V',
            'Х': 'X', 'Й': 'Y', 'З': 'Z', 'Э': 'E', 'Ъ': "'", 'Ь': ''
        };
        
        function convertToLatin(text) {
            let result = text;
            for (let [cyr, lat] of Object.entries(cyrillicToLatin)) {
                result = result.split(cyr).join(lat);
            }
            return result;
        }
        
        function convertToCyrillic(text) {
            let result = text;
            // Avval ikki harflilarni almashtirish
            const twoChar = ['yo', 'yu', 'ya', 'ye', 'sh', 'ch', 'ng', "o'", "g'", 
                            'Yo', 'Yu', 'Ya', 'Ye', 'Sh', 'Ch', 'Ng', "O'", "G'",
                            'YO', 'YU', 'YA', 'YE', 'SH', 'CH', 'NG'];
            for (let key of twoChar) {
                if (latinToCyrillic[key]) {
                    result = result.split(key).join(latinToCyrillic[key]);
                }
            }
            // Keyin bir harflilarni
            for (let [lat, cyr] of Object.entries(latinToCyrillic)) {
                if (lat.length === 1) {
                    result = result.split(lat).join(cyr);
                }
            }
            return result;
        }
        
        function matchesSearch(text, filter) {
            const textLower = text.toLowerCase();
            const filterLower = filter.toLowerCase();
            // To'g'ridan-to'g'ri tekshirish
            if (textLower.includes(filterLower)) return true;
            // Lotincha qidiruvni krillchaga aylantirish
            if (textLower.includes(convertToCyrillic(filterLower).toLowerCase())) return true;
            // Krillcha qidiruvni lotinchaga aylantirish
            if (textLower.includes(convertToLatin(filterLower).toLowerCase())) return true;
            // Matnni ikki xil formatda tekshirish
            if (convertToLatin(textLower).includes(filterLower)) return true;
            if (convertToCyrillic(textLower).includes(filterLower)) return true;
            return false;
        }
        
        const searchInput = document.getElementById('searchInput');
        const adabiyotList = document.getElementById('adabiyotList');
        searchInput.addEventListener('input', function() {
            const filter = this.value;
            const items = adabiyotList.querySelectorAll('.adabiyot-item');
            items.forEach(item => {
                const title = item.querySelector('.adabiyot-title');
                if (title) {
                    if (filter === '' || matchesSearch(title.textContent, filter)) {
                        item.style.display = '';
                    } else {
                        item.style.display = 'none';
                    }
                }
            });
        });
        </script>
    </div>
</body>
</html>
